اسم المشروع: نظام إدارة العيادة (Clinic)

ملخص تنفيذي
نظام إدارة العيادة هو تطبيق ويب متكامل لإدارة عمليات العيادات الطبية اليومية، مبني على Laravel ضمن هيكلية Domains مع دعم الصلاحيات والأدوار باستخدام Spatie Permission، وواجهات مبنية بـ Blade وLivewire لبعض الأجزاء التفاعلية. يوفر النظام لوحة تحكم إدارية، إدارة المرضى والزيارات، إدارة الأطباء/المستخدمين والصلاحيات، إدارة الخدمات الطبية، إدارة الأدوية، شاشة الكشف الطبي الذكية مع روشتة ديناميكية، وإصدار التقارير. كما يتضمن إعدادات عامة يتم تحميلها مركزيًا عبر موفر الإعدادات.

الفئة المستهدفة
- العيادات الخاصة والمتوسطة
- إدارات تكنولوجيا المعلومات في المراكز الطبية
- الأطباء والمديرون والمسؤولون عن الاستقبال والصيدلية

القيمة المضافة
- تسريع دورة العمل: استقبال المريض → إنشاء زيارة → كشف طبي → روشتة/تحاليل → تقارير.
- حوكمة الوصول: أدوار وصلاحيات دقيقة لكل وحدة وظيفية.
- تجربة استخدام سلسة للأطباء عبر شاشة كشف تفاعلية تدعم البحث السريع عن الأدوية وبناء الروشتة.

البنية المعمارية باختصار
- Laravel + هيكلية Domains: كل نطاق وظيفي يحتوي Controllers/Routes/Views/Models خاصته.
- تحميل تلقائي لـ Routes وViews وMigrations لكل Domain عبر `App\Providers\DomainServiceProvider`.
- الحماية والدخول: حارسات `admin` و`web` حسب `config/auth.php` مع وسيط `auth.admin` للوحات الإدارة.
- الصلاحيات والأدوار: Spatie Permission مع Seeder جاهز لإنشاء الأدوار والصلاحيات الأساسية.
- Livewire: تسجيل تلقائي لمكونات Livewire داخل كل Domain (عند وجودها)، مع استخدام فعلي لعرض سجل زيارات المريض.
- الإعدادات العامة: يجري تحميل أول سجل إعدادات إلى `config('settings')` عبر `SettingsServiceProvider` لإتاحته على مستوى التطبيق.
- الواجهة: قوالب Blade، وملفات JS/CSS مخصصة لبعض الشاشات (مثل شاشة الكشف).

الأدوار والصلاحيات (مثال شائع من Seeder)
- أدوار: super-admin، admin (وقابل للتوسعة: doctor، receptionist، pharmacist، reporter).
- صلاحيات تغطي: Dashboard، Users، Roles & Permissions، Settings، Services، Visits، Patients، Drugs، Examinations، Reports.
- يمكن إسناد كل صلاحية لروابط القائمة الجانبية (انظر `config/menu.php`) لضبط ظهور العناصر حسب دور المستخدم.

الوحدات الرئيسية في النظام
1) لوحة التحكم (Dashboard)
- نظرة عامة على مؤشرات العيادة (قابلة للتوسعة).
- الوصول عبر `/admin/dashboard` للمستخدمين المخولين.

2) الكشف الطبي (Examinations)
- شاشة كشف احترافية للزيارة الحالية تعرض:
  - بيانات المريض الأساسية (الاسم، العمر، الجنس، الحالة العامة، الحساسية من الأدوية).
  - نموذج التشخيص: أعراض، تشخيص.
  - الروشتة الطبية: بحث واقتراحات فورية للأدوية، إضافة جرعات/مدة/شكل الدواء/تعليمات لكل بند.
  - فحوص وطلبات: تحاليل/أشعة/كلاهما + تفاصيل مطلوبة.
  - ملاحظات إضافية + مرفقات (يدعم الرفع عبر Fancy Uploader).
  - زر حفظ الكشف (مقيد بصلاحية create examination).
- تبويب سجل الزيارات السابقة للمريض عبر Livewire لإتاحة الرجوع السريع للتاريخ المرضي.
- ملفات داعمة:
  - `app/Domains/Examinations/Views/admin/index.blade.php`
  - `public/assets/custom/js/examination.js` (منطق الاقتراحات وبناء الروشتة ديناميكيًا)

3) الزيارات (Visits)
- إدارة الزيارات: عرض الكل، إنشاء زيارة جديدة، تعديل/حذف (حسب الصلاحيات).
- غالبًا مرتبطة بالمريض والخدمة الطبية ونوع الزيارة وتاريخها.

4) المرضى (Patients)
- إدارة بيانات المرضى وربطها بحساب مستخدم إن وجد.
- حقول مساعدة مثل تاريخ الميلاد لحساب العمر، الحالة العامة، الحساسية من الأدوية…

5) الخدمات الطبية (Services)
- تعريف الخدمات التي تقدمها العيادة (مثال: كشف عام، متابعة، خدمة تخصصية).

6) الأدوية (Drugs)
- إدارة قاعدة بيانات الأدوية (إضافة/تعديل/حذف) مع دعم الاستيراد/التصدير (حسب الصلاحيات).

7) المستخدمون والصلاحيات (Users, Roles & Permissions)
- إدارة المستخدمين (إضافة/تعديل/حذف).
- إدارة الأدوار ومنحها صلاحيات.
- ربط المستخدمين بأدوار مختلفة لضبط الوصول لكل وحدة.

8) التقارير (Reports)
- الوصول المقيد بعرض/توليد التقارير.
- قابلة للتوسعة لإحصائيات المرضى والزيارات والخدمات والأدوية…

9) الإعدادات (Settings)
- إدارة إعدادات عامة للعيادة (يتم تحميلها إلى `config('settings')` تلقائيًا عند الإقلاع).
- تفيد في إظهار معلومات العيادة على الطباعة/التقارير وتخصيص سلوكيات عامة.

القائمة الجانبية والروابط
- ملف `config/menu.php` يضبط عناصر القائمة والروابط والأيقونات.
- يمكن تقييد ظهور عنصر عبر المفتاح `can` لربطه بصلاحية محددة.
- عناصر رئيسية مثبّتة: الرئيسية (Dashboard)، الكشف (Examinations)، التقارير، الزيارات، المرضى، الخدمات الطبية، الأدوية…

تدفق العمل اليومي المقترح
1) تسجيل الدخول إلى لوحة الإدارة.
2) من المرضى: إضافة مريض جديد أو اختيار مريض موجود.
3) من الزيارات: إنشاء زيارة جديدة للمريض وتحديد الخدمة.
4) من شاشة الكشف: فتح الكشف الحالي للمريض (إن وُجد) لإدخال الأعراض والتشخيص وبناء الروشتة وطلبات التحاليل/الأشعة وإرفاق ملفات، ثم حفظ.
5) من الأدوية: إدارة قاعدة الأدوية وتحديثها دوريًا، ليستفيد منها محرك الاقتراحات عند كتابة الروشتة.
6) من التقارير: استخراج التقارير المطلوبة حسب الصلاحيات.
7) من الإعدادات: ضبط بيانات العيادة العامة التي قد تظهر في رؤوس/تذييلات الطباعة والتقارير.

تعليمات استخدام شاشة الكشف (باختصار عملي)
- الأعراض/التشخيص: أدخل وصفًا واضحًا للحالة.
- الروشتة: اكتب اسم الدواء في خانة البحث؛ سيظهر صندوق اقتراحات فوري.
  - اختر الدواء أو اضغط Enter/Tab وفق الاختصار المتاح.
  - حدد الجرعة والمدة والشكل (قرص/شراب/حقنة/كبسولة) وتعليمات الاستخدام.
  - يمكن حذف أي سطر قبل الحفظ.
- التحاليل/الأشعة: اختر النوع المناسب واكتب التفاصيل المطلوبة بدقة.
- الملاحظات والمرفقات: أضف ما يدعم التشخيص والمتابعة (صور/تقارير سابقة).
- اضغط "حفظ الكشف" (تتطلب صلاحية create examination).

المتطلبات الفنية والتقنيات
- Laravel (تطبيق متعدد النطاقات Domains).
- Blade Templates + Livewire لبعض المكونات الحية.
- Spatie Permission لإدارة الأدوار والصلاحيات.
- Fancy Uploader وملفات رفع داعمة للمرفقات في الكشف.
- بنية التحميل التلقائي للنطاقات تحافظ على فصل واضح بين الوحدات.

الأمان والتحكم بالوصول
- الحارس الافتراضي يمكن تهيئته عبر `config/auth.php`، مع حارس `admin` للوحات الإدارة.
- وسيط `auth.admin` يؤمن مسارات `/admin/...`.
- الأدوار والصلاحيات تضبطها Seeder وتظهر تأثيرها على القائمة والواجهات والأزرار.

قابلية التوسعة
- إضافة Domain جديد بأمر `make:domain` المخصص (إن كان مفعّلًا) أو يدويًا باتّباع نفس الهيكل.
- كل نطاق يدعم مسارات ويب ومسارات إدارة وواجهاته ومهاجراته الخاصة.
- توسيع شاشة الكشف لإضافة قوالب روشتة جاهزة/طباعة الروشتة/تكامل مع طابعات أو ملفات PDF.
- توسيع التقارير بإحصاءات ورسوم بيانية وربطها بفلاتر زمنية/خدمية/طبية.

أفضل الممارسات التشغيلية
- إنشاء أدوار واضحة (طبيب، استقبال، صيدلي، مدير) ومنح الصلاحيات بدقة.
- تحديث قاعدة الأدوية دوريًا لتسهيل إدخال الروشتات وتسريع البحث.
- الالتزام بإدخال المرفقات ذات الصلة للحفاظ على ملف مرضي مكتمل.
- مراجعة الإعدادات العامة بعد التنصيب (شعار العيادة/بيانات الاتصال…).

نقاط مرجعية داخل المشروع
- مزود النطاقات: `app/Providers/DomainServiceProvider.php` (تحميل Routes/Views/Migrations وتسجيل Livewire).
- مزود الإعدادات: `app/Providers/SettingsServiceProvider.php` (تحميل الإعدادات إلى Config).
- القائمة الجانبية: `config/menu.php` (العناصر والروابط والصلاحيات).
- Seeder الصلاحيات: `database/seeders/RolePermissionSeeder.php` (الأدوار والصلاحيات والمستخدم الإداري الافتراضي إن وجد).
- شاشة الكشف: `app/Domains/Examinations/Views/admin/index.blade.php` مع السكربت `public/assets/custom/js/examination.js`.

إرشادات البداية السريعة للمسؤول
1) تشغيل المهاجرات وSeeder للصلاحيات (والحساب الإداري إن كان مضمّنًا).
2) تسجيل الدخول بحساب المدير.
3) مراجعة الإعدادات العامة من الواجهة (إن توفرت) أو من قاعدة البيانات ليتم تحميلها تلقائيًا.
4) إنشاء مستخدمين وأدوار وتوزيع الصلاحيات.
5) إدخال الخدمات الطبية والأدوية.
6) بدء التشغيل الفعلي: استقبال المرضى وإنشاء الزيارات وإجراء الكشف وحفظ الروشتات.

دعم وطباعة
- النظام يدعم المرفقات، ويمكن توسيع الطباعة (روشتة/تقارير) وفق متطلبات العيادة.

خاتمة
النظام مصمم ليكون عمليًا للطبيب ومرنًا للإدارة، مع قابلية عالية للتوسعة والصيانة بفضل هيكلية النطاقات والصلاحيات الدقيقة. يمكن تخصيص كل وحدة حسب احتياجات العيادة وإضافة تكاملات مستقبلية (SMS، فواتير، طباعة PDF، تكاملات مخبرية) بسهولة.


